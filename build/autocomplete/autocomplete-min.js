YUI.add("autocomplete-base",function(H){var J=H.Lang,O=H.Array,Q=J.isArray,D=J.isFunction,S=J.isNumber,V=J.trim,C="allowBrowserAutocomplete",P="dataSource",I="inputNode",Z="minQueryLength",X="query",T="queryDelay",F="queryDelimiter",B="requestTemplate",K="resultFilters",G="resultFormatter",E="resultHighlighter",a="resultLocator",M="results",L="value",R="valueChange",A="clear",U=X,N=M;function W(){this.publish(A,{defaultFn:this._defClearFn,queueable:true});this.publish(U,{defaultFn:this._defQueryFn,queueable:true});this.publish(N,{defaultFn:this._defResultsFn,queueable:true});}W.ATTRS={allowBrowserAutocomplete:{value:false,writeOnce:"initOnly"},dataSource:{validator:function(Y){return(Y&&D(Y.sendRequest))||Y===null;}},inputNode:{setter:H.one,writeOnce:"initOnly"},minQueryLength:{validator:S,value:1},query:{readOnly:true,value:null},queryDelay:{validator:function(Y){return S(Y)&&Y>=0;},value:150},queryDelimiter:{value:null},requestTemplate:{setter:function(Y){if(D(Y)){return Y;}Y=Y.toString();return function(b){return Y.replace(/(^|[^\\])((\\{2})*)\{query\}/,"$1$2"+encodeURIComponent(b)).replace(/(^|[^\\])((\\{2})*)\\(\{query\})/,"$1$2$4");};},value:encodeURIComponent},resultFilters:{validator:Q,value:[]},resultFormatter:{validator:"_functionValidator"},resultHighlighter:{validator:"_functionValidator"},resultLocator:{setter:function(Y){if(Y===null||D(Y)){return Y;}Y=Y.toString().split(".");return function(b){return H.Object.getValue(b,Y);};}},results:{readOnly:true,value:[]},value:{value:""}};W.CSS_PREFIX="ac";W.UI_SRC=(H.Widget&&H.Widget.UI_SRC)||"ui";W.prototype={bindInput:function(){var Y=this.get(I);if(!Y){H.error("No inputNode specified.");}this.unbindInput();this._inputEvents=[Y.on(R,this._onInputValueChange,this),this.after(R,this._afterValueChange,this)];},syncInput:function(){var Y=this.get(I);if(Y.get("nodeName").toLowerCase()==="input"){Y.setAttribute("autocomplete",this.get(C)?"on":"off");}this.set(L,Y.get(L));},unbindInput:function(){while(this._inputEvents&&this._inputEvents.length){this._inputEvents.pop().detach();}},_functionValidator:function(Y){return D(Y)||Y===null;},_parseResponse:function(l,b,f){var p={data:f,query:l,results:[]},g,o,q,c=b&&b.results,e=[],Y,n,m,d,k,h,j;if(c){Y=this.get(K);n=this.get(G);m=this.get(E);h=this.get(a);if(h){o=O.map(c,h);j=O.hash(o,c);}else{o=c;}for(d=0,k=Y.length;d<k;++d){o=Y[d](l,o);if(!o||!o.length){break;}}if(h){q=o;o=[];for(d=0,k=q.length;d<k;++d){o.push(j[q[d]]);}}else{q=[].concat(o);}g=m?m(l,q):[].concat(q);if(n){g=n(l,o,g,q);}for(d=0,k=g.length;d<k;++d){e.push({display:g[d],raw:o[d],text:q[d]});}p.results=e;}this.fire(N,p);},_parseValue:function(Y){var b=this.get(F);if(b){Y=Y.split(b);Y=Y[Y.length-1];}return this._trimLeft(Y);},_trimLeft:String.prototype.trimLeft?function(Y){return Y.trimLeft();}:function(Y){return Y.replace(/^\s+/,"");},_updateValue:function(b){var d=this.get(F),c,Y,e;b=this._trimLeft(b);if(d){c=V(d);e=O.map(V(this.get(L)).split(d),V);Y=e.length;if(Y>1){e[Y-1]=b;b=e.join(c+" ");}b=b+c+" ";}this.set(L,b);},_afterValueChange:function(g){var b,c,Y=g.newVal,f,d;if(g.src!==W.UI_SRC){this._inputNode.set(L,Y);return;}f=this._parseValue(Y);if(f&&f.length>=this.get(Z)){b=this.get(T);d=this;c=function(){d.fire(U,{inputValue:Y,query:f});};if(b){clearTimeout(this._delay);this._delay=setTimeout(c,b);}else{c();}}else{clearTimeout(this._delay);this.fire(A);}},_onResponse:function(b){var Y=b&&b.callback&&b.callback.query;if(Y&&Y===this.get(X)){this._parseResponse(Y,b.response,b.data);}},_onInputValueChange:function(b){var Y=b.newVal;if(Y===this.get(L)){return;}this.set(L,Y,{src:W.UI_SRC});},_defClearFn:function(){this._set(X,null);this._set(M,[]);},_defQueryFn:function(b){var c=this.get(P),Y=b.query;this._set(X,Y);if(Y&&c){c.sendRequest({request:this.get(B)(Y),callback:{query:Y,success:H.bind(this._onResponse,this)}});}},_defResultsFn:function(Y){this._set(M,Y[M]);}};H.AutoCompleteBase=W;},"@VERSION@",{requires:["array-extras","event-valuechange","node-base"]});YUI.add("autocomplete-list",function(B){var X=B.Node,L=B.Array,I=40,K=13,N=27,R=9,Q=38,U="_CLASS_ITEM",V="_CLASS_ITEM_ACTIVE",D="_CLASS_ITEM_HOVER",W="_SELECTOR_ITEM",G="activeItem",P="circular",T="hoveredItem",M="id",E="inputNode",F="item",C="list",Z="result",J="results",S="visible",H="width",O="select",A=B.Base.create("autocompleteList",B.Widget,[B.AutoCompleteBase,B.WidgetPosition,B.WidgetPositionAlign,B.WidgetStack],{ITEM_TEMPLATE:"<li/>",LIST_TEMPLATE:"<ul/>",initializer:function(){this.publish(O,{defaultFn:this._defSelectFn});this._events=[];this._inputNode=this.get(E);this[U]=this.getClassName(F);this[V]=this.getClassName(F,"active");this[D]=this.getClassName(F,"hover");this[W]="."+this[U];if(!this._inputNode){B.error("No inputNode specified.");}if(!this.get("align.node")){this.set("align.node",this._inputNode);}if(!this.get(H)){this.set(H,this._inputNode.get("offsetWidth"));}},destructor:function(){this.unbindInput();while(this._events.length){this._events.pop().detach();}},bindUI:function(){this._bindInput();this._bindList();},renderUI:function(){var Y=this.get("contentBox"),a=this.get("listNode");if(!a){a=X.create(this.LIST_TEMPLATE);a.addClass(this.getClassName(C)).setAttrs({id:B.stamp(a),role:"listbox"});Y.append(a);}this._inputNode.addClass(this.getClassName("input")).setAttrs({"aria-autocomplete":C,"aria-live":"polite","aria-owns":a.get(M),role:"combobox"});this._contentBox=Y;this._listNode=a;},syncUI:function(){this.syncInput();this._syncResults();this._syncVisibility();},hide:function(){return this.set(S,false);},selectItem:function(Y){if(Y){if(!Y.hasClass(this[U])){return;}}else{Y=this.get(G);if(!Y){return;}}this.fire(O,{itemNode:Y,result:Y.getData(Z)});return this;},show:function(){return this.set(S,true);},_activateNextItem:function(){var a=this.get(G),Y;Y=(a&&a.next(this[W]))||this.get(P)&&this._getFirstItemNode();if(Y){this._set(G,Y);}return this;},_activatePrevItem:function(){var a=this.get(G),Y;Y=(a&&a.previous(this[W]))||this.get(P)&&this._getLastItemNode();
if(Y){this._set(G,Y);}return this;},_add:function(Y){var a=[];L.each(B.Lang.isArray(Y)?Y:[Y],function(b){a.push(this._createItemNode(b).setData(Z,b));},this);a=B.all(a);this._listNode.append(a.toFrag());return a;},_bindInput:function(){var Y=this._inputNode;this.bindInput();this._events.concat([Y.on("blur",this._onInputBlur,this),Y.on(B.UA.gecko?"keypress":"keydown",this._onInputKey,this)]);},_bindList:function(){this._events.concat([this.after("mouseover",this._afterMouseOver,this),this.after("mouseout",this._afterMouseOut,this),this.after("activeItemChange",this._afterActiveItemChange,this),this.after("hoveredItemChange",this._afterHoveredItemChange,this),this.after("resultsChange",this._afterResultsChange,this),this.after("visibleChange",this._afterVisibleChange,this),this._listNode.delegate("click",this._onItemClick,this[W],this)]);},_clear:function(){this._set(G,null);this._set(T,null);this._listNode.get("children").remove(true);},_createItemNode:function(Y){var a=X.create(this.ITEM_TEMPLATE);return a.addClass(this[U]).setAttrs({id:B.stamp(a),role:"option"}).append(Y.display);},_getLastItemNode:function(){return this._listNode.one(this[W]+":last-child");},_getFirstItemNode:function(){return this._listNode.one(this[W]);},_syncResults:function(a){var Y;if(!a){a=this.get(J);}this._clear();if(a.length){Y=this._add(a);}},_syncVisibility:function(Y){if(Y===undefined){Y=this.get(S);}this._contentBox.set("aria-hidden",!Y);if(!Y){this._set(G,null);this._set(T,null);}},_afterActiveItemChange:function(a){var Y=a.newVal,b=a.prevVal;if(b){b.removeClass(this[V]);}if(Y){Y.addClass(this[V]);this._inputNode.set("aria-activedescendant",Y.get(M));}},_afterHoveredItemChange:function(a){var Y=a.newVal,b=a.prevVal;if(b){b.removeClass(this[D]);}if(Y){Y.addClass(this[D]);}},_afterMouseOver:function(Y){var a=Y.domEvent.target.ancestor(this[W],true);this._mouseOverList=true;if(a){this._set(T,a);}},_afterMouseOut:function(){this._mouseOverList=false;this._set(T,null);},_afterResultsChange:function(Y){this._syncResults(Y.newVal);this.set(S,!!Y.newVal.length);},_afterVisibleChange:function(Y){this._syncVisibility(!!Y.newVal);},_onInputBlur:function(Y){if(this._mouseOverList&&this._lastInputKey!==R){this._inputNode.focus();}else{this.hide();}},_onInputKey:function(b){var Y,a=b.keyCode,c;this._lastInputKey=a;if(!this.get(J).length){return;}c=this.get(S);if(a===I){Y=1;if(!c){this.show();}this._activateNextItem();}if(c){switch(a){case K:Y=1;this.selectItem();break;case N:Y=1;this.hide();break;case Q:Y=1;this._activatePrevItem();break;}}if(Y){b.preventDefault();}},_onItemClick:function(Y){var a=Y.currentTarget;Y.preventDefault();this._set(G,a);this.selectItem(a);},_defSelectFn:function(Y){this._inputNode.focus();this._updateValue(Y.result.text);this.hide();}},{ATTRS:{activeItem:{readOnly:true,value:null},align:{value:{points:["tl","bl"]}},circular:{value:true},hoveredItem:{readOnly:true,value:null},visible:{value:false}},CSS_PREFIX:B.ClassNameManager.getClassName("aclist"),HTML_PARSER:{listNode:function(){return this.getClassName(C);}}});B.AutoCompleteList=A;B.AutoComplete=A;},"@VERSION@",{requires:["autocomplete-base","widget","widget-position","widget-position-align","widget-stack"],skinnable:true});YUI.add("autocomplete",function(A){},"@VERSION@",{use:["autocomplete-base","autocomplete-list"]});