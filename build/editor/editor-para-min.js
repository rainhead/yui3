YUI.add("editor-para",function(G){var C=function(){C.superclass.constructor.apply(this,arguments);},B="host",D="body",A="nodeChange",F=D+" > p",E="p";G.extend(C,G.Base,{_fixFirstPara:function(){var H=this.get(B),J=H.getInstance(),I;J.one("body").set("innerHTML","<"+E+">"+J.Selection.CURSOR+"</"+E+">");I=new J.Selection();I.focusCursor(true,false);},_onNodeChange:function(O){var T=this.get(B),N=T.getInstance();switch(O.changedType){case"enter":if(G.UA.webkit){if(O.changedEvent.shiftKey){T.execCommand("insertbr");O.changedEvent.preventDefault();}}if(G.UA.gecko&&T.get("defaultblock")!=="p"){var Q=O.changedNode,P,J,L=N.Selection.DEFAULT_BLOCK_TAG;if(!Q.test(L)){Q=Q.ancestor(L);}P=N.Node.create("<"+L+">"+N.Selection.CURSOR+"</"+L+">");J=new N.Selection();Q.insert(P,"after");J.focusCursor(true,false);O.changedEvent.preventDefault();}break;case"keydown":if(N.config.doc.childNodes.length<2){var U=N.config.doc.body.innerHTML;if(U&&U.length<5&&U.toLowerCase()=="<br>"){this._fixFirstPara();}}break;case"backspace-up":case"backspace-down":case"delete-up":if(!G.UA.ie){var H=N.all(F),S,R,M,K,I;R=N.one(D);if(H.item(0)){R=H.item(0);}S=R.one("br");if(S){S.removeAttribute("id");S.removeAttribute("class");}K=N.Selection.getText(R);K=K.replace(/ /g,"").replace(/\n/g,"");if(K.length===0){if(!R.test(E)){this._fixFirstPara();}I=null;if(O.changedNode&&O.changedNode.test(E)){I=O.changedNode;}if(!I&&T._lastPara&&T._lastPara.inDoc()){I=T._lastPara;}if(I&&!I.test(E)){I=I.ancestor(E);}if(I){if(!I.previous()&&I.get("parentNode").test(D)){O.changedEvent.frameEvent.halt();}}}if(G.UA.webkit){if(O.changedNode){R=O.changedNode;if(R.test("li")&&(!R.previous()&&!R.next())){M=R.get("innerHTML").replace("<br>","");if(M===""){if(R.get("parentNode")){R.get("parentNode").replace(N.Node.create("<br>"));O.changedEvent.frameEvent.halt();O.preventDefault();N.Selection.filterBlocks();}}}}}}break;}},_afterEditorReady:function(){var I=this.get(B),J=I.getInstance(),H;if(J){J.Selection.filterBlocks();H=J.Selection.DEFAULT_BLOCK_TAG;F=D+" > "+H;E=H;}},_afterContentChange:function(){var H=this.get(B),I=H.getInstance();if(I&&I.Selection){I.Selection.filterBlocks();}},_afterPaste:function(){var H=this.get(B),J=H.getInstance(),I=new J.Selection();G.later(50,H,function(){J.Selection.filterBlocks();});},initializer:function(){var H=this.get(B);H.on(A,G.bind(this._onNodeChange,this));H.after("ready",G.bind(this._afterEditorReady,this));H.after("contentChange",G.bind(this._afterContentChange,this));if(G.Env.webkit){H.after("dom:paste",G.bind(this._afterPaste,this));}}},{NAME:"editorPara",NS:"editorPara",ATTRS:{host:{value:false}}});G.namespace("Plugin");G.Plugin.EditorPara=C;},"@VERSION@",{requires:["editor-base","selection"],skinnable:false});